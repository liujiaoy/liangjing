<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试固定表头</title>
    <script src="../jquery.min.js"></script>
    <script src="jquery.fixedTableHead.js"></script>
    <script src="excel.js"></script>
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            text-align: center;
        }
        .test th{
            background-color: #ccc;
        }
        button{
            margin:4px;
        }
        #table{
            /* width: 500px; */
            height:500px;
            overflow-y: auto;
        }
        .top{
            position: fixed;
            top:80%;
            right:5px;
            border: 1px solid #888;
            border-radius: 10%;
            background-color: #fff;
            cursor: pointer;
            z-index: 2;
            padding: 5px;
        }
        .top a{
            background-color: #fff;
            color:#000;
            text-decoration:none;
        }
        .hide_top{
            display: none;
        }
    </style>
    <script>
        $(function(){
            $("#test").fixedTableHead(0);
        })

    </script>
    <script>
    function exportTable() {
      // 获取头部和body
      var data = LAY_EXCEL.tableToJson(document.getElementById('LAY-EXPORT-TEST')) // 或者 $('#LAY-EXPORT-TEST')
      // console.log(data)
      var exportData = []
      exportData.push.apply(exportData, data.head)
      exportData.push.apply(exportData, data.body)
      // console.log(exportData)

      LAY_EXCEL.exportExcel(exportData, '表格导出.xlsx', 'xlsx')

      
var filename = "file.xlsx"; //文件名称
var data = [[1,2,3],[true, false, null, "sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"), "0.3"], ["baz", null, "qux"]];  //数据，一定注意需要时二维数组
var ws_name = "Sheet1"; //Excel第一个sheet的名称
var wb = XLSX.utils.book_new(), ws = XLSX.utils.aoa_to_sheet(data);
XLSX.utils.book_append_sheet(wb, ws, ws_name);  //将数据添加到工作薄
XLSX.writeFile(wb, filename); //导出Excel

    }
    </script>
</head>

<body>
    <div>
        <div id="Totop" class="hide_top">返回顶部</div>
        <div class="top"><a href="#Totop">返回顶部</a></div>
        <div onclick="exportTable">导出</div>
        <div class="table-div">
            <table id="test" class="test" border="0" cellspacing="0" cellpadding="0" width="100%">
                <thead id="theadId">
                    <tr>
                        <th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th><th>111</th>
                    </tr>
                    <tr>
                        <th colspan="3">222</th><th colspan="4">222</th><th colspan="3">222</th><th>222</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>5465464</td>
                        <td>000</td>
                        <td>000</td>
                        <td>4444</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr><tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr><tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr><tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr><tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr><tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                        <td>000</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>